<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Badminton Community</title>
		<style>
			body, html {
			height: 100%;
			width: 100%;
			padding: 0;
			margin: 0;
			}
			#map {
				width: 100%;
				min-height: 100%;
			}
		</style>
	</head>
	<body>
		
		<div id="map">
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
			<script>
				function initMap() {
					var location = {lat: 45.4717, lng: -73.4718};
					var map = new google.maps.Map(document.getElementById('map'), {
						zoom: 11,
						center: location
					});
										//					var marker = new google.maps.Marker({
												//						position: location,
												//						map: map
										//					});
					
					var url = 'https://sportplaces-api.herokuapp.com/api/v1/places?origin=-73.4718,45.4717&radius=99&sports=132'
					map.data.loadGeoJson(url)
					
					var places
					
					$.ajax({
						url: url,
						method: 'GET',
						dataType: 'JSON',
						data: {},
						success: function(data) {
							createIwContent(data.features)
							
						},
						error: function(err) {
							console.log('error:' + err)
						}
					})
					
					
					function createIwContent (places) {
						var placesObjects = places
						console.log(placesObjects)
						
						for (i = 0; i < placesObjects.length; i++){
							var contentString = '<div id="content">'+
												'<div id="siteNotice">'+
												'</div>'+
												'<h1 id="placeHeading" class="placeHeading">' + placesObjects[i].properties.name + '</h1>'+
												'<div id="bodyContent">'+
														'<p>Phone: 450-679-6131 ' +
																'Address: 550 Boulevard Curé-Poirier Ouest, Longueuil '+
																'Québec, Canada '+
																'J4J 2H6'+
																'Website: <a href="complexesportiflongueuil.com/en/home/complexesportiflongueuil.com/en/home">complexesportiflongueuil.com/en/home/</a></p>'+
														'</div>'+
												'</div>';
								}
					
								createInfoWindow(contentString)
							}
							
							function createInfoWindow (iwContent) {
								var infowindow = new google.maps.InfoWindow({
									content: iwContent
								});
									
								map.data.addListener('click', function(event) {
										infowindow.setContent('<div style="width:50px;">' + event.feature.getProperty('htmlContent') + '</div>');
										infowindow.setOptions({
											pixelOffset: new google.maps.Size(0, -36)
										});
										infowindow.setPosition(event.feature.getGeometry().get());
										infowindow.open(map);
										google.maps.event.addListenerOnce(infowindow, 'domready', function() {
											infowindow.close();
											infowindow.open(map);
										});
									});
								
								
								}
							createInfoWindow()
						}
							
				</script>
				<script async defer
					src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB88gtQGJZeD3uJ_74estIOyyIhR0Oq2TY&callback=initMap">
				</script>
				
			</div>
		</body>
	</html>